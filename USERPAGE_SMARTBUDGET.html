<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings | Smart Personal Budget</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js for visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* CSS Variables and Themes */
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #10b981;
            --accent-color: #8b5cf6;
            --danger-color: #ef4444;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --info-color: #0ea5e9;
            --background-color: #f9fafb;
            --text-color: #111827;
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            transition: all 0.3s ease;
            background-color: var(--background-color);
            color: var(--text-color);
        }
        
        /* ========== COLOR-BLIND FRIENDLY THEMES ========== */
        
        /* 1. PROTANOPIA (Red-Blind) Theme */
        .theme-protanopia {
            --primary-color: #1e40af;        /* Dark blue instead of red */
            --secondary-color: #047857;      /* Dark green */
            --accent-color: #d97706;         /* Amber for alerts/warnings */
            --danger-color: #7c3aed;         /* Purple instead of red for danger */
            --success-color: #059669;        /* Green stays but darker */
            --warning-color: #f59e0b;        /* Yellow stays */
            --info-color: #0ea5e9;           /* Blue stays */
            --background-color: #f8fafc;
            --card-bg: #ffffff;
            --text-color: #1e293b;
            --border-color: #cbd5e1;
            --shadow-color: rgba(30, 41, 59, 0.1);
        }
        
        /* 2. DEUTERANOPIA (Green-Blind) Theme */
        .theme-deuteranopia {
            --primary-color: #2563eb;        /* Blue instead of green-dependent colors */
            --secondary-color: #7c3aed;      /* Purple for secondary */
            --accent-color: #ea580c;         /* Orange for highlights */
            --danger-color: #dc2626;         /* Red (still visible as darker) */
            --success-color: #0d9488;        /* Teal instead of green */
            --warning-color: #f59e0b;
            --info-color: #0284c7;
            --background-color: #f9fafb;
            --card-bg: #ffffff;
            --text-color: #111827;
            --border-color: #d1d5db;
            --shadow-color: rgba(17, 24, 39, 0.1);
        }
        
        /* 3. TRITANOPIA (Blue-Yellow Blind) Theme */
        .theme-tritanopia {
            --primary-color: #dc2626;        /* Red (distinct from blue) */
            --secondary-color: #059669;      /* Green (not blue-tinted) */
            --accent-color: #7c3aed;         /* Purple */
            --danger-color: #dc2626;         /* Red */
            --success-color: #059669;        /* Green */
            --warning-color: #ea580c;        /* Orange instead of yellow */
            --info-color: #0d9488;           /* Teal instead of blue */
            --background-color: #fef3c7;     /* Light amber background */
            --card-bg: #ffffff;
            --text-color: #451a03;           /* Dark brown text */
            --border-color: #fbbf24;
            --shadow-color: rgba(120, 53, 15, 0.1);
        }
        
        /* Standard Themes */
        .theme-dark {
            --primary-color: #60a5fa;
            --secondary-color: #34d399;
            --accent-color: #a78bfa;
            --danger-color: #f87171;
            --success-color: #34d399;
            --warning-color: #fbbf24;
            --info-color: #38bdf8;
            --background-color: #1f2937;
            --text-color: #f9fafb;
            --card-bg: #374151;
            --border-color: #4b5563;
            --shadow-color: rgba(0, 0, 0, 0.3);
        }
        
        .theme-light-blue {
            --primary-color: #0ea5e9;
            --secondary-color: #06b6d4;
            --accent-color: #8b5cf6;
            --danger-color: #ef4444;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --info-color: #0ea5e9;
            --background-color: #f0f9ff;
            --card-bg: #ffffff;
            --text-color: #0c4a6e;
            --border-color: #bae6fd;
            --shadow-color: rgba(14, 165, 233, 0.1);
        }
        
        /* Custom Components */
        .card {
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px var(--shadow-color), 0 2px 4px -1px var(--shadow-color);
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 0.5rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .btn-secondary:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .input-field {
            width: 100%;
            padding: 0.625rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            background-color: var(--card-bg);
            color: var(--text-color);
            transition: all 0.2s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary-color) 20%, transparent);
        }
        
        .category-tag {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        /* Status indicators for accessibility */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            margin: 0.25rem;
        }
        
        /* Color-blind friendly status indicators */
        .theme-protanopia .status-success {
            background-color: #0d9488 !important;
            color: white !important;
        }
        
        .theme-protanopia .status-danger {
            background-color: #7c3aed !important;
            color: white !important;
        }
        
        .theme-protanopia .status-warning {
            background-color: #f59e0b !important;
            color: #451a03 !important;
        }
        
        .theme-deuteranopia .status-success {
            background-color: #0d9488 !important;
            color: white !important;
        }
        
        .theme-deuteranopia .status-danger {
            background-color: #dc2626 !important;
            color: white !important;
        }
        
        .theme-deuteranopia .status-warning {
            background-color: #ea580c !important;
            color: white !important;
        }
        
        .theme-tritanopia .status-success {
            background-color: #059669 !important;
            color: white !important;
        }
        
        .theme-tritanopia .status-danger {
            background-color: #dc2626 !important;
            color: white !important;
        }
        
        .theme-tritanopia .status-warning {
            background-color: #ea580c !important;
            color: white !important;
        }
        
        .theme-tritanopia .status-info {
            background-color: #0d9488 !important;
            color: white !important;
        }
        
        /* Print styles */
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            body {
                background-color: white !important;
                color: black !important;
            }
            
            .card {
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Animation classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Accessibility focus styles */
        :focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .btn-primary, .btn-secondary {
                border: 2px solid currentColor;
            }
            
            .input-field {
                border: 2px solid var(--border-color);
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- Header/Navigation -->
    <header class="sticky top-0 z-50 bg-white shadow-md no-print">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-wallet text-blue-500 text-2xl"></i>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">Smart Personal Budget</h1>
                        <p class="text-xs text-gray-500">Group 6 Project</p>
                    </div>
                </div>
                
                <nav class="hidden md:flex space-x-6">
                    <a href="dashboard.html" class="text-gray-600 hover:text-blue-500 transition-colors duration-200">
                        <i class="fas fa-chart-pie mr-1"></i> Dashboard
                    </a>
                    <a href="expenses.html" class="text-gray-600 hover:text-blue-500 transition-colors duration-200">
                        <i class="fas fa-receipt mr-1"></i> Expenses
                    </a>
                    <a href="budget.html" class="text-gray-600 hover:text-blue-500 transition-colors duration-200">
                        <i class="fas fa-chart-line mr-1"></i> Budget
                    </a>
                    <a href="settings.html" class="text-blue-500 font-medium border-b-2 border-blue-500 pb-1">
                        <i class="fas fa-cog mr-1"></i> Settings
                    </a>
                    <a href="about.html" class="text-gray-600 hover:text-blue-500 transition-colors duration-200">
                        <i class="fas fa-users mr-1"></i> About
                    </a>
                </nav>
                
                <button id="mobileMenuBtn" class="md:hidden text-gray-600 hover:text-blue-500 transition-colors duration-200">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="md:hidden mt-4 hidden slide-in">
                <div class="flex flex-col space-y-2 bg-gray-50 rounded-lg p-4">
                    <a href="dashboard.html" class="flex items-center text-gray-600 hover:text-blue-500 transition-colors duration-200 py-2 px-3 hover:bg-blue-50 rounded">
                        <i class="fas fa-chart-pie mr-3"></i> Dashboard
                    </a>
                    <a href="expenses.html" class="flex items-center text-gray-600 hover:text-blue-500 transition-colors duration-200 py-2 px-3 hover:bg-blue-50 rounded">
                        <i class="fas fa-receipt mr-3"></i> Expenses
                    </a>
                    <a href="budget.html" class="flex items-center text-gray-600 hover:text-blue-500 transition-colors duration-200 py-2 px-3 hover:bg-blue-50 rounded">
                        <i class="fas fa-chart-line mr-3"></i> Budget
                    </a>
                    <a href="settings.html" class="flex items-center text-blue-500 font-medium bg-blue-50 py-2 px-3 rounded">
                        <i class="fas fa-cog mr-3"></i> Settings
                    </a>
                    <a href="about.html" class="flex items-center text-gray-600 hover:text-blue-500 transition-colors duration-200 py-2 px-3 hover:bg-blue-50 rounded">
                        <i class="fas fa-users mr-3"></i> About
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8">
        <!-- Page Header -->
        <div class="mb-8 fade-in">
            <div class="flex items-center mb-2">
                <i class="fas fa-cog text-3xl text-blue-500 mr-3"></i>
                <h2 class="text-2xl font-bold text-gray-800">User Settings</h2>
            </div>
            <p class="text-gray-600">Customize your budget tracker preferences and appearance</p>
        </div>
        
        <!-- Settings Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column: Settings Forms -->
            <div class="lg:col-span-2 space-y-8">
                <!-- User Profile Card -->
                <section class="card p-6 fade-in">
                    <div class="flex items-center mb-6">
                        <div class="bg-blue-100 p-3 rounded-full mr-4">
                            <i class="fas fa-user-circle text-2xl text-blue-600"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800">User Profile</h3>
                            <p class="text-gray-600">Manage your personal information</p>
                        </div>
                    </div>
                    
                    <form id="profileForm" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium" for="userName">
                                    <i class="fas fa-user mr-2 text-gray-400"></i>Full Name
                                </label>
                                <input type="text" id="userName" class="input-field"
                                       value="John Doe" required>
                                <p class="text-xs text-gray-500 mt-1">Your display name in the application</p>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium" for="userEmail">
                                    <i class="fas fa-envelope mr-2 text-gray-400"></i>Email Address
                                </label>
                                <input type="email" id="userEmail" class="input-field"
                                       value="john.doe@example.com" required>
                                <p class="text-xs text-gray-500 mt-1">For notifications and account recovery</p>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium" for="userCurrency">
                                    <i class="fas fa-money-bill-wave mr-2 text-gray-400"></i>Preferred Currency
                                </label>
                                <select id="userCurrency" class="input-field">
                                    <option value="USD">US Dollar ($)</option>
                                    <option value="EUR">Euro (€)</option>
                                    <option value="GBP">British Pound (£)</option>
                                    <option value="MYR" selected>Malaysian Ringgit (RM)</option>
                                    <option value="JPY">Japanese Yen (¥)</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium" for="userLanguage">
                                    <i class="fas fa-language mr-2 text-gray-400"></i>Language
                                </label>
                                <select id="userLanguage" class="input-field">
                                    <option value="en" selected>English</option>
                                    <option value="ms">Bahasa Malaysia</option>
                                    <option value="zh">中文</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between pt-4 border-t border-gray-200">
                            <div id="profileSaveMsg" class="text-sm hidden"></div>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-save mr-2"></i>Save Profile
                            </button>
                        </div>
                    </form>
                </section>
                
                <!-- Color-Blind Friendly Themes Card -->
                <section class="card p-6 fade-in">
                    <div class="flex items-center mb-6">
                        <div class="bg-green-100 p-3 rounded-full mr-4">
                            <i class="fas fa-palette text-2xl text-green-600"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800">Accessibility Themes</h3>
                            <p class="text-gray-600">Optimized for users with color vision deficiencies</p>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="text-lg font-medium text-gray-800 mb-4">Color-Blind Friendly Themes</h4>
                        <p class="text-gray-600 mb-4">These themes are specifically designed for common types of color vision deficiency:</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Protanopia Theme -->
                            <div class="theme-option cursor-pointer border-2 border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all duration-200" 
                                 data-theme="protanopia">
                                <div class="h-20 bg-gradient-to-r from-blue-900 to-emerald-700 p-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-white font-medium">Protanopia</span>
                                        <i class="fas fa-eye text-white"></i>
                                    </div>
                                </div>
                                <div class="p-4 bg-white">
                                    <p class="font-medium text-gray-800 mb-2">Red-Blind Theme</p>
                                    <p class="text-sm text-gray-600 mb-3">For red-green color blindness where red appears dark brown/gray</p>
                                    <div class="flex space-x-1">
                                        <div class="w-4 h-4 bg-blue-900 rounded"></div>
                                        <div class="w-4 h-4 bg-emerald-700 rounded"></div>
                                        <div class="w-4 h-4 bg-amber-500 rounded"></div>
                                        <div class="w-4 h-4 bg-purple-600 rounded"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Deuteranopia Theme -->
                            <div class="theme-option cursor-pointer border-2 border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all duration-200" 
                                 data-theme="deuteranopia">
                                <div class="h-20 bg-gradient-to-r from-blue-700 to-purple-600 p-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-white font-medium">Deuteranopia</span>
                                        <i class="fas fa-eye text-white"></i>
                                    </div>
                                </div>
                                <div class="p-4 bg-white">
                                    <p class="font-medium text-gray-800 mb-2">Green-Blind Theme</p>
                                    <p class="text-sm text-gray-600 mb-3">For red-green color blindness where green appears brown/yellowish</p>
                                    <div class="flex space-x-1">
                                        <div class="w-4 h-4 bg-blue-700 rounded"></div>
                                        <div class="w-4 h-4 bg-purple-600 rounded"></div>
                                        <div class="w-4 h-4 bg-orange-500 rounded"></div>
                                        <div class="w-4 h-4 bg-teal-600 rounded"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tritanopia Theme -->
                            <div class="theme-option cursor-pointer border-2 border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all duration-200" 
                                 data-theme="tritanopia">
                                <div class="h-20 bg-gradient-to-r from-red-600 to-amber-500 p-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-white font-medium">Tritanopia</span>
                                        <i class="fas fa-eye text-white"></i>
                                    </div>
                                </div>
                                <div class="p-4 bg-white">
                                    <p class="font-medium text-gray-800 mb-2">Blue-Yellow Blind</p>
                                    <p class="text-sm text-gray-600 mb-3">For blue-yellow confusion where yellow appears pale</p>
                                    <div class="flex space-x-1">
                                        <div class="w-4 h-4 bg-red-600 rounded"></div>
                                        <div class="w-4 h-4 bg-green-600 rounded"></div>
                                        <div class="w-4 h-4 bg-orange-500 rounded"></div>
                                        <div class="w-4 h-4 bg-teal-600 rounded"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Standard Themes -->
                    <div class="mb-6">
                        <h4 class="text-lg font-medium text-gray-800 mb-4">Standard Themes</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                            <div class="theme-option cursor-pointer border-2 border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all duration-200" 
                                 data-theme="default">
                                <div class="h-16 bg-gradient-to-r from-blue-500 to-green-400"></div>
                                <div class="p-3 bg-white">
                                    <p class="font-medium text-center">Default</p>
                                </div>
                            </div>
                            
                            <div class="theme-option cursor-pointer border-2 border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all duration-200" 
                                 data-theme="dark">
                                <div class="h-16 bg-gradient-to-r from-gray-800 to-gray-600"></div>
                                <div class="p-3 bg-gray-800 text-white">
                                    <p class="font-medium text-center">Dark Mode</p>
                                </div>
                            </div>
                            
                            <div class="theme-option cursor-pointer border-2 border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all duration-200" 
                                 data-theme="light-blue">
                                <div class="h-16 bg-gradient-to-r from-blue-300 to-blue-100"></div>
                                <div class="p-3 bg-blue-50">
                                    <p class="font-medium text-center">Light Blue</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Accessibility Tips -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6">
                        <div class="flex items-start">
                            <i class="fas fa-lightbulb text-blue-500 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-medium text-blue-800 mb-2">Accessibility Tips</h4>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li>• <strong>Protanopia:</strong> Avoids red-green combinations, uses blue/purple/amber</li>
                                    <li>• <strong>Deuteranopia:</strong> Replaces green with teal, uses distinct blues/purples</li>
                                    <li>• <strong>Tritanopia:</strong> Avoids blue-yellow confusion, uses red/green/orange</li>
                                    <li>• All themes maintain high contrast for better readability</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between pt-6 border-t border-gray-200 mt-6">
                        <div>
                            <p class="text-gray-700">Current theme: 
                                <span id="currentThemeDisplay" class="font-medium bg-blue-100 text-blue-800 px-3 py-1 rounded-full">Default</span>
                            </p>
                        </div>
                        <button id="resetThemeBtn" class="btn-secondary">
                            <i class="fas fa-undo-alt mr-2"></i>Reset to Default
                        </button>
                    </div>
                </section>
                
                <!-- Budget Preferences Card -->
                <section class="card p-6 fade-in">
                    <div class="flex items-center mb-6">
                        <div class="bg-purple-100 p-3 rounded-full mr-4">
                            <i class="fas fa-sliders-h text-2xl text-purple-600"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800">Budget Preferences</h3>
                            <p class="text-gray-600">Configure your budgeting rules and categories</p>
                        </div>
                    </div>
                    
                    <form id="preferencesForm" class="space-y-6">
                        <div>
                            <label class="block text-gray-700 mb-2 font-medium" for="budgetCycle">
                                <i class="fas fa-calendar-alt mr-2 text-gray-400"></i>Budget Cycle
                            </label>
                            <select id="budgetCycle" class="input-field">
                                <option value="weekly">Weekly</option>
                                <option value="biweekly">Bi-weekly</option>
                                <option value="monthly" selected>Monthly</option>
                                <option value="quarterly">Quarterly</option>
                            </select>
                            <p class="text-xs text-gray-500 mt-1">How often your budget resets</p>
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2 font-medium">
                                <i class="fas fa-tags mr-2 text-gray-400"></i>Expense Categories
                            </label>
                            <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
                                <div class="mb-4">
                                    <p class="text-sm text-gray-600 mb-3">Current categories:</p>
                                    <div id="categoriesContainer" class="flex flex-wrap gap-2 mb-4">
                                        <!-- Categories will be populated here -->
                                    </div>
                                </div>
                                
                                <div class="flex items-center">
                                    <input type="text" id="newCategory" 
                                           class="input-field rounded-r-none"
                                           placeholder="Enter new category name">
                                    <button type="button" id="addCategoryBtn" 
                                            class="btn-primary rounded-l-none">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-2">Press Enter or click + to add a new category</p>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="flex items-center">
                                <input type="checkbox" id="enableNotifications" class="h-5 w-5 text-blue-500 rounded" checked>
                                <label for="enableNotifications" class="ml-3 text-gray-700">
                                    <span class="font-medium">Enable budget notifications</span>
                                    <p class="text-sm text-gray-500">Receive alerts when approaching budget limits</p>
                                </label>
                            </div>
                            
                            <div class="flex items-center">
                                <input type="checkbox" id="autoCategorize" class="h-5 w-5 text-blue-500 rounded">
                                <label for="autoCategorize" class="ml-3 text-gray-700">
                                    <span class="font-medium">Auto-categorize expenses</span>
                                    <p class="text-sm text-gray-500">Automatically categorize expenses based on keywords</p>
                                </label>
                            </div>
                        </div>
                        
                        <div class="flex justify-end pt-4 border-t border-gray-200">
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-save mr-2"></i>Save Preferences
                            </button>
                        </div>
                    </form>
                </section>
            </div>
            
            <!-- Right Column: Summary and Tools -->
            <div class="space-y-8">
                <!-- Settings Summary Card -->
                <section class="card p-6 fade-in">
                    <div class="flex items-center mb-6">
                        <div class="bg-blue-100 p-3 rounded-full mr-4">
                            <i class="fas fa-clipboard-list text-xl text-blue-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800">Settings Summary</h3>
                    </div>
                    
                    <div class="space-y-4 mb-8">
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Theme:</span>
                            <span id="summaryTheme" class="font-medium">Default</span>
                        </div>
                        
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Currency:</span>
                            <span id="summaryCurrency" class="font-medium">MYR (RM)</span>
                        </div>
                        
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Budget Cycle:</span>
                            <span id="summaryCycle" class="font-medium">Monthly</span>
                        </div>
                        
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Notifications:</span>
                            <span id="summaryNotifications" class="font-medium">Enabled</span>
                        </div>
                        
                        <div class="flex justify-between items-center py-2">
                            <span class="text-gray-600">Auto-categorization:</span>
                            <span id="summaryAutoCategorize" class="font-medium">Disabled</span>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-medium text-gray-800 mb-4">Export Tools</h4>
                        <div class="space-y-3">
                            <button id="exportSettingsBtn" 
                                    class="w-full btn-secondary flex items-center justify-center">
                                <i class="fas fa-file-export mr-2"></i>Export Settings as JSON
                            </button>
                            
                            <button id="printSettingsBtn" 
                                    class="w-full btn-primary flex items-center justify-center">
                                <i class="fas fa-print mr-2"></i>Print Settings Summary
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- Data Visualization Card -->
                <section class="card p-6 fade-in">
                    <div class="flex items-center mb-6">
                        <div class="bg-green-100 p-3 rounded-full mr-4">
                            <i class="fas fa-chart-pie text-xl text-green-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800">Category Distribution</h3>
                    </div>
                    
                    <div class="h-64">
                        <canvas id="categoryChart"></canvas>
                    </div>
                    
                    <div class="mt-4 grid grid-cols-2 gap-2">
                        <div class="status-indicator bg-blue-100 text-blue-800">
                            <i class="fas fa-utensils mr-2"></i>Food & Dining
                        </div>
                        <div class="status-indicator bg-green-100 text-green-800">
                            <i class="fas fa-bus mr-2"></i>Transportation
                        </div>
                        <div class="status-indicator bg-purple-100 text-purple-800">
                            <i class="fas fa-film mr-2"></i>Entertainment
                        </div>
                        <div class="status-indicator bg-yellow-100 text-yellow-800">
                            <i class="fas fa-shopping-cart mr-2"></i>Shopping
                        </div>
                    </div>
                </section>
                
                <!-- Quick Actions Card -->
                <section class="card p-6 fade-in">
                    <div class="flex items-center mb-6">
                        <div class="bg-purple-100 p-3 rounded-full mr-4">
                            <i class="fas fa-bolt text-xl text-purple-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800">Quick Actions</h3>
                    </div>
                    
                    <div class="space-y-3">
                        <button id="resetAllBtn" 
                                class="w-full btn-secondary flex items-center justify-center">
                            <i class="fas fa-undo mr-2"></i>Reset All Settings
                        </button>
                        
                        <button id="backupDataBtn" 
                                class="w-full btn-secondary flex items-center justify-center">
                            <i class="fas fa-database mr-2"></i>Backup All Data
                        </button>
                        
                        <a href="about.html" 
                           class="w-full btn-secondary flex items-center justify-center">
                            <i class="fas fa-users mr-2"></i>View Team Members
                        </a>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-12 no-print">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center mb-4">
                        <i class="fas fa-wallet text-blue-400 text-2xl mr-3"></i>
                        <h2 class="text-xl font-bold">Smart Personal Budget</h2>
                    </div>
                    <p class="text-gray-400">A responsive web application for tracking personal finances and managing budgets effectively.</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="dashboard.html" class="text-gray-400 hover:text-white transition-colors duration-200">Dashboard</a></li>
                        <li><a href="expenses.html" class="text-gray-400 hover:text-white transition-colors duration-200">Expense Tracker</a></li>
                        <li><a href="budget.html" class="text-gray-400 hover:text-white transition-colors duration-200">Budget Planner</a></li>
                        <li><a href="about.html" class="text-gray-400 hover:text-white transition-colors duration-200">About Team</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Project Info</h3>
                    <p class="text-gray-400">
                        <strong>Course:</strong> ITT588 - Front-End Technologies<br>
                        <strong>Semester:</strong> October 2025 - February 2026<br>
                        <strong>Group:</strong> 6<br>
                        <strong>Project:</strong> Smart Personal Budget & Expense Tracker
                    </p>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2025 Smart Personal Budget Tracker. All rights reserved.</p>
                <p class="mt-2">This project follows Shneiderman's 8 Golden Rules of Interface Design</p>
            </div>
        </div>
    </footer>

    <!-- Print Section (Hidden by default) -->
    <div id="printSection" class="print-only hidden">
        <div class="p-8">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold mb-2">Smart Personal Budget</h1>
                <h2 class="text-xl text-gray-600">Settings Summary Report</h2>
                <div class="border-t border-gray-300 my-4"></div>
            </div>
            
            <div class="mb-8">
                <p><strong>Report Generated:</strong> <span id="printDate"></span></p>
                <p><strong>User:</strong> <span id="printUserName"></span></p>
                <p><strong>Email:</strong> <span id="printUserEmail"></span></p>
            </div>
            
            <div class="border border-gray-300 rounded-lg p-6 mb-8">
                <h2 class="text-xl font-bold mb-4 pb-2 border-b border-gray-300">Current Settings</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p><strong>Theme:</strong></p>
                        <p id="printTheme" class="text-gray-700">Default Theme</p>
                    </div>
                    <div>
                        <p><strong>Currency:</strong></p>
                        <p id="printCurrency" class="text-gray-700">MYR (RM)</p>
                    </div>
                    <div>
                        <p><strong>Budget Cycle:</strong></p>
                        <p id="printCycle" class="text-gray-700">Monthly</p>
                    </div>
                    <div>
                        <p><strong>Notifications:</strong></p>
                        <p id="printNotifications" class="text-gray-700">Enabled</p>
                    </div>
                    <div>
                        <p><strong>Auto-categorization:</strong></p>
                        <p id="printAutoCategorize" class="text-gray-700">Disabled</p>
                    </div>
                    <div>
                        <p><strong>Language:</strong></p>
                        <p id="printLanguage" class="text-gray-700">English</p>
                    </div>
                </div>
            </div>
            
            <div class="border border-gray-300 rounded-lg p-6">
                <h2 class="text-xl font-bold mb-4 pb-2 border-b border-gray-300">Expense Categories</h2>
                <div id="printCategories" class="flex flex-wrap gap-2">
                    <!-- Categories will be populated here -->
                </div>
            </div>
            
            <div class="mt-12 pt-8 border-t border-gray-300 text-center text-gray-600">
                <p>--- End of Settings Summary ---</p>
                <p class="mt-4">Smart Personal Budget Tracker &copy; 2025 | Group 6 Project</p>
                <p class="text-sm">ITT588 - Front-End Technologies | October 2025 - February 2026</p>
            </div>
        </div>
    </div>

    <!-- JavaScript Module -->
    <script>
        // ============================================
        // MAIN APPLICATION MODULE
        // ============================================
        const BudgetApp = (function() {
            // Private variables
            let categoryChart = null;
            let currentTheme = 'default';
            
            // Default categories with colors
            const defaultCategories = [
                { name: 'Food & Dining', color: 'bg-blue-100', text: 'text-blue-800', icon: 'fa-utensils' },
                { name: 'Transportation', color: 'bg-green-100', text: 'text-green-800', icon: 'fa-bus' },
                { name: 'Entertainment', color: 'bg-purple-100', text: 'text-purple-800', icon: 'fa-film' },
                { name: 'Shopping', color: 'bg-yellow-100', text: 'text-yellow-800', icon: 'fa-shopping-cart' },
                { name: 'Bills & Utilities', color: 'bg-red-100', text: 'text-red-800', icon: 'fa-file-invoice-dollar' },
                { name: 'Healthcare', color: 'bg-indigo-100', text: 'text-indigo-800', icon: 'fa-heart-pulse' }
            ];
            
            // Available color classes for new categories
            const categoryColors = [
                { bg: 'bg-blue-100', text: 'text-blue-800' },
                { bg: 'bg-green-100', text: 'text-green-800' },
                { bg: 'bg-purple-100', text: 'text-purple-800' },
                { bg: 'bg-yellow-100', text: 'text-yellow-800' },
                { bg: 'bg-red-100', text: 'text-red-800' },
                { bg: 'bg-indigo-100', text: 'text-indigo-800' },
                { bg: 'bg-pink-100', text: 'text-pink-800' },
                { bg: 'bg-gray-100', text: 'text-gray-800' }
            ];
            
            // Color-blind theme explanations
            const themeExplanations = {
                'protanopia': 'Protanopia (Red-Blind): This theme avoids red-green combinations by using blue (#1e40af), purple (#7c3aed), and amber (#d97706) colors. Red is replaced with dark blue, and danger indicators use purple instead of red.',
                'deuteranopia': 'Deuteranopia (Green-Blind): This theme replaces green-dependent colors with blues (#2563eb), purples (#7c3aed), and teals (#0d9488). Success indicators use teal instead of green for better distinction.',
                'tritanopia': 'Tritanopia (Blue-Yellow Blind): This theme avoids blue-yellow confusion by using red (#dc2626), green (#059669), and orange (#ea580c) colors. The background is light amber (#fef3c7) for better contrast.'
            };
            
            // ============================================
            // INITIALIZATION FUNCTIONS
            // ============================================
            
            function init() {
                console.log('Initializing Budget App Settings...');
                
                // Initialize all components
                initEventListeners();
                initCategories();
                initChart();
                loadSavedSettings();
                updateSummary();
                
                console.log('Budget App Settings initialized successfully');
            }
            
            function initEventListeners() {
                // Mobile menu
                document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);
                
                // Forms
                document.getElementById('profileForm').addEventListener('submit', saveProfile);
                document.getElementById('preferencesForm').addEventListener('submit', savePreferences);
                
                // Theme selection
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.addEventListener('click', function() {
                        selectTheme(this.dataset.theme);
                    });
                });
                
                // Reset theme
                document.getElementById('resetThemeBtn').addEventListener('click', resetTheme);
                
                // Category management
                document.getElementById('addCategoryBtn').addEventListener('click', addCategory);
                document.getElementById('newCategory').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addCategory();
                    }
                });
                
                // Export/Print
                document.getElementById('exportSettingsBtn').addEventListener('click', exportSettings);
                document.getElementById('printSettingsBtn').addEventListener('click', printSettings);
                
                // Quick actions
                document.getElementById('resetAllBtn').addEventListener('click', resetAllSettings);
                document.getElementById('backupDataBtn').addEventListener('click', backupData);
            }
            
            function initCategories() {
                const container = document.getElementById('categoriesContainer');
                container.innerHTML = '';
                
                defaultCategories.forEach(category => {
                    const categoryElement = createCategoryElement(category.name, category.color, category.text);
                    container.appendChild(categoryElement);
                });
                
                // Also populate print section
                updatePrintCategories();
            }
            
            function initChart() {
                const ctx = document.getElementById('categoryChart').getContext('2d');
                categoryChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: defaultCategories.map(c => c.name),
                        datasets: [{
                            data: [30, 15, 10, 20, 15, 10],
                            backgroundColor: [
                                '#3b82f6', // blue
                                '#10b981', // green
                                '#8b5cf6', // purple
                                '#f59e0b', // yellow
                                '#ef4444', // red
                                '#6366f1'  // indigo
                            ],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    usePointStyle: true,
                                    pointStyle: 'circle'
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.parsed}%`;
                                    }
                                }
                            }
                        },
                        cutout: '60%'
                    }
                });
            }
            
            // ============================================
            // THEME MANAGEMENT FUNCTIONS
            // ============================================
            
            function selectTheme(themeName) {
                // Remove all theme classes
                const themeClasses = ['theme-protanopia', 'theme-deuteranopia', 'theme-tritanopia', 
                                     'theme-dark', 'theme-light-blue'];
                document.body.classList.remove(...themeClasses);
                
                // Add selected theme
                if (themeName !== 'default') {
                    document.body.classList.add(`theme-${themeName}`);
                }
                
                // Update current theme
                currentTheme = themeName;
                
                // Update UI
                updateThemeDisplay(themeName);
                
                // Save to localStorage
                localStorage.setItem('budgetAppTheme', themeName);
                
                // Visual feedback
                highlightSelectedTheme(themeName);
                
                // Show explanation for color-blind themes
                if (themeExplanations[themeName]) {
                    showNotification(themeExplanations[themeName], 'info');
                } else {
                    showNotification(`Theme changed to ${getThemeDisplayName(themeName)}`, 'success');
                }
            }
            
            function resetTheme() {
                selectTheme('default');
                showNotification('Theme reset to default', 'info');
            }
            
            function updateThemeDisplay(themeName) {
                const displayName = getThemeDisplayName(themeName);
                document.getElementById('currentThemeDisplay').textContent = displayName;
                document.getElementById('summaryTheme').textContent = displayName;
                document.getElementById('printTheme').textContent = displayName;
                
                // Update theme indicator color
                const indicator = document.getElementById('currentThemeDisplay');
                indicator.className = 'font-medium px-3 py-1 rounded-full';
                
                if (themeName === 'protanopia') {
                    indicator.classList.add('bg-blue-900', 'text-white');
                } else if (themeName === 'deuteranopia') {
                    indicator.classList.add('bg-blue-700', 'text-white');
                } else if (themeName === 'tritanopia') {
                    indicator.classList.add('bg-red-600', 'text-white');
                } else if (themeName === 'dark') {
                    indicator.classList.add('bg-gray-800', 'text-white');
                } else if (themeName === 'light-blue') {
                    indicator.classList.add('bg-blue-100', 'text-blue-800');
                } else {
                    indicator.classList.add('bg-blue-100', 'text-blue-800');
                }
            }
            
            function getThemeDisplayName(themeName) {
                const themeNames = {
                    'default': 'Default',
                    'dark': 'Dark Mode',
                    'light-blue': 'Light Blue',
                    'protanopia': 'Protanopia (Red-Blind)',
                    'deuteranopia': 'Deuteranopia (Green-Blind)',
                    'tritanopia': 'Tritanopia (Blue-Yellow Blind)'
                };
                return themeNames[themeName] || themeName;
            }
            
            function highlightSelectedTheme(themeName) {
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.classList.remove('border-blue-500', 'border-2');
                    option.classList.add('border-gray-200');
                    
                    if (option.dataset.theme === themeName) {
                        option.classList.remove('border-gray-200');
                        option.classList.add('border-blue-500', 'border-2');
                    }
                });
            }
            
            // ============================================
            // CATEGORY MANAGEMENT FUNCTIONS
            // ============================================
            
            function createCategoryElement(name, bgClass, textClass) {
                const div = document.createElement('div');
                div.className = 'category-tag relative group';
                div.innerHTML = `
                    <span class="${bgClass} ${textClass} px-3 py-1 rounded-full">${name}</span>
                    <button class="category-remove-btn absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 text-xs opacity-0 group-hover:opacity-100 transition-opacity">
                        ×
                    </button>
                `;
                
                // Add remove event listener
                const removeBtn = div.querySelector('.category-remove-btn');
                removeBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    removeCategory(name);
                });
                
                return div;
            }
            
            function addCategory() {
                const input = document.getElementById('newCategory');
                const categoryName = input.value.trim();
                
                if (!categoryName) {
                    showNotification('Please enter a category name', 'error');
                    return;
                }
                
                // Check if category already exists
                const existingCategories = Array.from(document.querySelectorAll('.category-tag span'))
                    .map(span => span.textContent);
                
                if (existingCategories.includes(categoryName)) {
                    showNotification('Category already exists', 'error');
                    input.focus();
                    return;
                }
                
                // Get random color for new category
                const colorIndex = Math.floor(Math.random() * categoryColors.length);
                const color = categoryColors[colorIndex];
                
                // Add to container
                const container = document.getElementById('categoriesContainer');
                const categoryElement = createCategoryElement(categoryName, color.bg, color.text);
                container.appendChild(categoryElement);
                
                // Update print categories
                updatePrintCategories();
                
                // Clear input
                input.value = '';
                input.focus();
                
                showNotification(`Category "${categoryName}" added`, 'success');
            }
            
            function removeCategory(categoryName) {
                if (defaultCategories.some(c => c.name === categoryName)) {
                    showNotification('Default categories cannot be removed', 'error');
                    return;
                }
                
                // Find and remove category element
                const categoryElements = document.querySelectorAll('.category-tag');
                categoryElements.forEach(element => {
                    if (element.querySelector('span').textContent === categoryName) {
                        element.remove();
                    }
                });
                
                // Update print categories
                updatePrintCategories();
                
                showNotification(`Category "${categoryName}" removed`, 'success');
            }
            
            function updatePrintCategories() {
                const container = document.getElementById('printCategories');
                container.innerHTML = '';
                
                const categories = Array.from(document.querySelectorAll('.category-tag span'))
                    .map(span => span.textContent);
                
                categories.forEach(category => {
                    const div = document.createElement('div');
                    div.className = 'inline-block bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm mr-2 mb-2';
                    div.textContent = category;
                    container.appendChild(div);
                });
            }
            
            // ============================================
            // FORM HANDLING FUNCTIONS
            // ============================================
            
            function saveProfile(e) {
                e.preventDefault();
                
                const userName = document.getElementById('userName').value;
                const userEmail = document.getElementById('userEmail').value;
                const currency = document.getElementById('userCurrency').value;
                const language = document.getElementById('userLanguage').value;
                
                // Validate
                if (!userName || !userEmail) {
                    showNotification('Please fill in all required fields', 'error');
                    return;
                }
                
                // Save to localStorage
                const profileData = { userName, userEmail, currency, language };
                localStorage.setItem('budgetAppProfile', JSON.stringify(profileData));
                
                // Update summary
                updateSummary();
                
                // Update print section
                document.getElementById('printUserName').textContent = userName;
                document.getElementById('printUserEmail').textContent = userEmail;
                document.getElementById('printLanguage').textContent = 
                    document.getElementById('userLanguage').options[document.getElementById('userLanguage').selectedIndex].text;
                document.getElementById('printCurrency').textContent = 
                    document.getElementById('userCurrency').options[document.getElementById('userCurrency').selectedIndex].text;
                
                // Show success message
                const messageDiv = document.getElementById('profileSaveMsg');
                messageDiv.textContent = 'Profile saved successfully!';
                messageDiv.className = 'text-sm text-green-600 font-medium';
                messageDiv.classList.remove('hidden');
                
                // Hide message after 3 seconds
                setTimeout(() => {
                    messageDiv.classList.add('hidden');
                }, 3000);
                
                showNotification('Profile settings saved', 'success');
            }
            
            function savePreferences(e) {
                e.preventDefault();
                
                const budgetCycle = document.getElementById('budgetCycle').value;
                const enableNotifications = document.getElementById('enableNotifications').checked;
                const autoCategorize = document.getElementById('autoCategorize').checked;
                
                // Save to localStorage
                const preferences = { budgetCycle, enableNotifications, autoCategorize };
                localStorage.setItem('budgetAppPreferences', JSON.stringify(preferences));
                
                // Update summary
                updateSummary();
                
                // Update print section
                document.getElementById('printCycle').textContent = 
                    document.getElementById('budgetCycle').options[document.getElementById('budgetCycle').selectedIndex].text;
                document.getElementById('printNotifications').textContent = enableNotifications ? 'Enabled' : 'Disabled';
                document.getElementById('printAutoCategorize').textContent = autoCategorize ? 'Enabled' : 'Disabled';
                
                showNotification('Preferences saved successfully', 'success');
            }
            
            // ============================================
            // EXPORT/PRINT FUNCTIONS
            // ============================================
            
            function exportSettings() {
                // Gather all settings data
                const settings = {
                    profile: {
                        userName: document.getElementById('userName').value,
                        userEmail: document.getElementById('userEmail').value,
                        currency: document.getElementById('userCurrency').value,
                        language: document.getElementById('userLanguage').value
                    },
                    theme: currentTheme,
                    preferences: {
                        budgetCycle: document.getElementById('budgetCycle').value,
                        enableNotifications: document.getElementById('enableNotifications').checked,
                        autoCategorize: document.getElementById('autoCategorize').checked
                    },
                    categories: Array.from(document.querySelectorAll('.category-tag span')).map(span => span.textContent),
                    exportDate: new Date().toISOString(),
                    appInfo: {
                        name: 'Smart Personal Budget Tracker',
                        version: '1.0.0',
                        group: 'Group 6',
                        course: 'ITT588 - Front-End Technologies'
                    }
                };
                
                // Convert to JSON
                const dataStr = JSON.stringify(settings, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                // Create download link
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', `budget-settings-${new Date().toISOString().slice(0,10)}.json`);
                document.body.appendChild(linkElement);
                linkElement.click();
                document.body.removeChild(linkElement);
                
                showNotification('Settings exported successfully', 'success');
            }
            
            function printSettings() {
                // Update print date
                const now = new Date();
                document.getElementById('printDate').textContent = 
                    now.toLocaleDateString('en-US', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                
                // Show print section and print
                const printSection = document.getElementById('printSection');
                printSection.classList.remove('hidden');
                
                window.print();
                
                // Hide after printing
                setTimeout(() => {
                    printSection.classList.add('hidden');
                }, 100);
            }
            
            // ============================================
            // UTILITY FUNCTIONS
            // ============================================
            
            function toggleMobileMenu() {
                const menu = document.getElementById('mobileMenu');
                menu.classList.toggle('hidden');
                
                const icon = document.querySelector('#mobileMenuBtn i');
                if (menu.classList.contains('hidden')) {
                    icon.className = 'fas fa-bars text-xl';
                } else {
                    icon.className = 'fas fa-times text-xl';
                }
            }
            
            function updateSummary() {
                // Update currency
                document.getElementById('summaryCurrency').textContent = 
                    document.getElementById('userCurrency').options[document.getElementById('userCurrency').selectedIndex].text;
                
                // Update budget cycle
                document.getElementById('summaryCycle').textContent = 
                    document.getElementById('budgetCycle').options[document.getElementById('budgetCycle').selectedIndex].text;
                
                // Update notifications
                document.getElementById('summaryNotifications').textContent = 
                    document.getElementById('enableNotifications').checked ? 'Enabled' : 'Disabled';
                
                // Update auto-categorization
                document.getElementById('summaryAutoCategorize').textContent = 
                    document.getElementById('autoCategorize').checked ? 'Enabled' : 'Disabled';
            }
            
            function loadSavedSettings() {
                // Load theme
                const savedTheme = localStorage.getItem('budgetAppTheme');
                if (savedTheme) {
                    selectTheme(savedTheme);
                }
                
                // Load profile
                const savedProfile = localStorage.getItem('budgetAppProfile');
                if (savedProfile) {
                    try {
                        const profile = JSON.parse(savedProfile);
                        document.getElementById('userName').value = profile.userName || 'John Doe';
                        document.getElementById('userEmail').value = profile.userEmail || 'john.doe@example.com';
                        document.getElementById('userCurrency').value = profile.currency || 'MYR';
                        document.getElementById('userLanguage').value = profile.language || 'en';
                        
                        // Update print section
                        document.getElementById('printUserName').textContent = profile.userName || 'John Doe';
                        document.getElementById('printUserEmail').textContent = profile.userEmail || 'john.doe@example.com';
                    } catch (e) {
                        console.error('Error loading profile:', e);
                    }
                }
                
                // Load preferences
                const savedPreferences = localStorage.getItem('budgetAppPreferences');
                if (savedPreferences) {
                    try {
                        const preferences = JSON.parse(savedPreferences);
                        document.getElementById('budgetCycle').value = preferences.budgetCycle || 'monthly';
                        document.getElementById('enableNotifications').checked = preferences.enableNotifications !== false;
                        document.getElementById('autoCategorize').checked = preferences.autoCategorize || false;
                    } catch (e) {
                        console.error('Error loading preferences:', e);
                    }
                }
            }
            
            function resetAllSettings() {
                if (confirm('Are you sure you want to reset all settings to default? This action cannot be undone.')) {
                    // Clear localStorage
                    localStorage.removeItem('budgetAppTheme');
                    localStorage.removeItem('budgetAppProfile');
                    localStorage.removeItem('budgetAppPreferences');
                    
                    // Reset forms to default
                    document.getElementById('profileForm').reset();
                    document.getElementById('preferencesForm').reset();
                    
                    // Reset theme
                    selectTheme('default');
                    
                    // Reset categories
                    initCategories();
                    
                    // Update summary
                    updateSummary();
                    
                    showNotification('All settings have been reset to default', 'success');
                }
            }
            
            function backupData() {
                // In a real app, this would backup all user data
                // For now, we'll just show a notification
                showNotification('Data backup feature would be implemented in a full application', 'info');
                
                // Simulate backup process
                setTimeout(() => {
                    showNotification('Backup completed successfully', 'success');
                }, 1500);
            }
            
            function showNotification(message, type = 'info') {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 max-w-md`;
                
                // Set background color based on type
                const bgColors = {
                    'success': 'bg-green-500',
                    'error': 'bg-red-500',
                    'info': 'bg-blue-500',
                    'warning': 'bg-yellow-500'
                };
                
                notification.className += ` ${bgColors[type] || 'bg-blue-500'} text-white`;
                
                // Add icon based on type
                const icons = {
                    'success': 'fas fa-check-circle',
                    'error': 'fas fa-exclamation-circle',
                    'info': 'fas fa-info-circle',
                    'warning': 'fas fa-exclamation-triangle'
                };
                
                notification.innerHTML = `
                    <div class="flex items-start">
                        <i class="${icons[type] || 'fas fa-info-circle'} mr-3 mt-1"></i>
                        <span class="flex-1">${message}</span>
                        <button class="ml-3 text-white hover:text-gray-200">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                // Add close button functionality
                const closeBtn = notification.querySelector('button');
                closeBtn.addEventListener('click', function() {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                });
                
                // Add to document
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 10);
                
                // Auto-remove after 5 seconds (longer for info messages)
                const duration = type === 'info' ? 8000 : 5000;
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, duration);
            }
            
            // ============================================
            // PUBLIC API
            // ============================================
            
            return {
                init: init,
                selectTheme: selectTheme,
                resetTheme: resetTheme,
                addCategory: addCategory,
                saveProfile: saveProfile,
                savePreferences: savePreferences,
                exportSettings: exportSettings,
                printSettings: printSettings,
                resetAllSettings: resetAllSettings
            };
        })();
        
        // ============================================
        // INITIALIZE APPLICATION WHEN DOM IS LOADED
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            BudgetApp.init();
        });
    </script>
</body>
</html>